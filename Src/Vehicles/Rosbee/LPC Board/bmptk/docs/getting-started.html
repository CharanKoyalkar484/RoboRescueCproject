<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Bare Metal Programming Tool Kit: Getting Started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bmptk-blue.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bare Metal Programming Tool Kit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Getting Started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="install-bmptk"></a></p>
<h2>bmptk</h2>
<p>To start using bmptk you must first get bmptk itself and place it somwehere on your PC. It does not care where, but I'll assume you put it in C:\bmptk.</p>
<p>You can download the bleeding edge code from <a href="http://code.google.com/p/bmptk" target="_blank">google code</a>, or get it as a git repository: </p>
<div class="fragment"><div class="line">git clone https:<span class="comment">//code.google.com/p/bmptk</span></div>
</div><!-- fragment --><hr/>
<p> <a class="anchor" id="install-python"></a></p>
<h2>Python</h2>
<p>The bmptk font and image conversion tools can be used to convert images, fonts, or text, to code. These tools are Python scripts, and use the Pillow library (a Python Imaging Library fork).</p>
<p>Hence to use these tools you must install both Python and (a matching) Pillow, Note that not for all Python versions are ready-made Pillow version can be found. I use Python 3.3.2 (<a href="http://www.python.org/ftp/python/3.3.2/python-3.3.2.msi">direct link</a>) with the matching Pillow from <a href=""></a> (<a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/w9rir8do/Pillow-2.1.0.win32-py3.3.exe">direct link</a>).</p>
<p>Multiple Python versions can coexits on your machine. When your Python is not 3.3 or is not installed in it default directory (C:\Python33) the Makefile.local must be copied to Makefile.custom and edited to reflect the directory python is installed in.</p>
<hr/>
<p> <a class="anchor" id="install-toolchain"></a></p>
<h2>Toolchains</h2>
<p>Bmptk can generate executables for a number of targets. You need to install only the toolchains for the targets that you are interested in. The supported targets are:</p>
<ul>
<li><a class="el" href="targets.html#target-windows">Windows</a>: uses <a class="el" href="getting-started.html#install-windows">Orwell DevCpp</a> to create windows executables</li>
<li><a class="el" href="targets.html#target-nds">Nintendo DS</a>: uses <a class="el" href="getting-started.html#install-nds">DevKitPro</a> to create and DeSmuME to run NDS applications</li>
<li><a class="el" href="targets.html#target-lpc1114">LPC1114</a>: uses the <a class="el" href="getting-started.html#install-arm">MentorGraphics/CodeSourcery GCC</a> toolchain for ARM</li>
</ul>
<p><a class="anchor" id="install-windows"></a></p>
<h3>for Windows</h3>
<p>To create and run applications for Windows you must install the <a href="http://orwelldevcpp.blogspot.nl/">Orwell DevCpp</a> IDE. Take the MinGW32 version, I used 4.7.2 (<a href="http://sourceforge.net/projects/orwelldevcpp/files/Setup%20Releases/Dev-Cpp%205.4.2%20MinGW%204.7.2%20Setup.exe/download">direct link</a>).</p>
<p>Bmptk uses only the toolchain (compiler, linker, libraries) of this IDE, not the editor.</p>
<p>This target is not meant to be used to develop full-featured windows applications, but to test-run your code on a Windows platform.</p>
<p>The win target support a graphic screen (bmptk::graphics::target_screen) and a character output (std::cout). Don't expect real-time performance from the win target: your PC will do other things beside running the application.</p>
<p><a class="anchor" id="install-nds"></a></p>
<h3>for Nintendo DS</h3>
<p>To create and run applications for the Nintendo DS game console you must install the DevKitARM version of the <a href="http://devkitpro.org/">DevKitPro</a> development environment, and (if you want to test-run on your PC) the DeSmuME emulator. I used the devkitProUpdater 1.5.3 (<a href="http://sourceforge.net/projects/devkitpro/files/Automated%20Installer/devkitProUpdater-1.5.3.exe/download">direct link</a>). <a href="http://www.desmume.com/">DeSmuME</a> is a zip file, which you must unpack to the emulators\desmume subdirectory of your devkitPro installation. I used version 0.9.8 (<a href="http://www.desmume.com.nyud.net/download/DeSmuME.0.9.8-win32.zip">direct link</a>)</p>
<p><a class="anchor" id="install-arm"></a></p>
<h3>for ARM chips</h3>
<p>To create and run applications for ARM chips (including the newer Cortex versions) you must install the MentorGraphics <a href="http://www.mentor.com/embedded-software/sourcery-tools/sourcery-codebench/editions/lite-edition/">Sourcery CodeBench Lite Edition</a>, EABI release, for ARM. To get this toolchain, you must create an account and log in.</p>
<hr/>
<p> <a class="anchor" id="install-configuration"></a></p>
<h2>bmptk configuration</h2>
<p>Bmptk must be able to find the various tools (Python, compiler tool chain(s)) that it needs. By default bmptk assumes that thall tools are installed in their default locations on drive C. If this is the case for you, you can ignore this section.</p>
<p>When you have installed one or more tools in a different location (or for Python, you used a different version) you must do the following:</p>
<ul>
<li>in the btmptk root directory, make a copy of the Mafefile.local file and call it Makefile.custom</li>
<li>in that Makefile.custom, edit the appropriate lines to reflect where you put the tools.</li>
</ul>
<p>The purpose of this is that when you install a new version of bmptk over the old one, your Makefile.custom (which is not present in bmptk) will be preserved.</p>
<p>Depending on the Windows variety you have tools that have a Windows installer can install either in C:\Program Files or in C:\Program Files (x86). The Makefile.local file will take care of this.</p>
<hr/>
<p> <a class="anchor" id="install-editors"></a></p>
<h2>Editors</h2>
<p>You can use bmptk from the command line, but it is probably easier to use an editor, if only to jump to the source line where the compiler found an error. A <a class="el" href="editors.html">number of editors</a> are supported, choose your favourite and install it. I prefer <a class="el" href="editors.html#pspad">PSPad</a>, not because it is the world's best editor, but because the integration with bmptk is simple and reliable. </p>
<hr/>
<p> <a class="anchor" id="install-test"></a></p>
<h2>A first test</h2>
<p>For a first test you can go to one of the examples, for instance</p>
<ul>
<li>bmptk\examples\db103\blink (LPC1114 target)</li>
<li>bmptk\examples\graphics\draw (nds target)</li>
<li>bmptk\examples\graphics\lines (win target)</li>
</ul>
<p>You can start the PSPad editor (assuming you have installed it) by double-clicking on the _project.ppr file. If that does not work immediately, associate the .ppr extension with the editor's executable.</p>
<p>In the editor, press CTRL-F9 or click the file-to-10101 icon to build the application. Next you can press SHIFT-F9 or click the file-with-lightningbolt icon and select run to run the application. For the win target this will run the application. For the nds target it will start the DesMuME emulator to run the application. For a microntroller target this will start the download tool to download the application to the microcontroller and run it.</p>
<p>If things don't work as expected, the window in which the action takes place often closes before you can read what has happened. In this case, try the install-command-line command line.</p>
<hr/>
<p> <a class="anchor" id="install-start-a-project"></a></p>
<h2>Start your own project: adapt the Makefile</h2>
<p>To start a new bmptk project you can either copy an example, or copy the bmptk/Makefile.template to your_directory.</p>
<p>The Makefile contains the instructions for the make tool to build your project. The Makefile in your project directory contains only the project-specific aspects. As its last line it includes the bmptk/Makfile.inc, which does the real work.</p>
<p>The makefile must know where to find the bmptk files. The example directories are three directories deep in the bmptk tree, so the Mafiles in the examples have the line</p>
<div class="fragment"><div class="line"><span class="preprocessor"># specify where the bmptk files can be found</span></div>
<div class="line"><span class="preprocessor">BMPTK      := ../../..</span></div>
</div><!-- fragment --><p>If you place your new project somewhere within the bmptk tree you might have to change the number of ../'s. If you place a bmptk project outside the bmptk tree you should probably specify an absolute path, like</p>
<div class="fragment"><div class="line">BMPTK      := C:/bmptk</div>
</div><!-- fragment --><p>By default the Makefile assumes that main.cpp (or main.c, or main.asm) is the one and only source file to be compiled, and that this is to be the (base) name of the project files (executable, map file, etc) that are to be generated. If your project has a different name, you must mention it in the Makefile, (without extension):</p>
<div class="fragment"><div class="line"><span class="preprocessor"># specify the name of the project</span></div>
<div class="line"><span class="preprocessor">PROJECT    := alarmclock</span></div>
</div><!-- fragment --><p>If your project has more source files than just the main file, you must add them in the makefile. You can specify the files explicity:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Specify project-specific files (other than the main, if any)</span></div>
<div class="line"><span class="preprocessor"></span>SOURCES    += display.c timer.cpp</div>
<div class="line">HEADERS    += display.h timer.hpp</div>
</div><!-- fragment --><p>The sources are the files that will be compiled. When any of the headers are changed, the makefile will re-compile all your source files. This is a bit conservative, but at least it is on the safe side.</p>
<p>Alternatively, you can specify the header files, and the system will assume that source files (.asm, .c, or .cpp) with the same base name exist and must be compiled.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Specify header files that have a corresponding source file</span></div>
<div class="line"><span class="preprocessor">LIBRARIES  += display.h timer.hpp</span></div>
</div><!-- fragment --><p>If you have object files that must be included in your application, you can specify those too. If any of these files do not exits, the system will attempt to make them, from an existing .asm, .c or .cpp file.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Specify object files that must be linked with the application</span></div>
<div class="line"><span class="preprocessor">OBJECTS  += blob.o</span></div>
</div><!-- fragment --><p>If some of the files are not in the current directory you must specify in which directories the system must look for missing files.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Specify locations weher the system must look for files</span></div>
<div class="line"><span class="preprocessor">SEARCH  += ../uart ../timer</span></div>
</div><!-- fragment --><p>When a serial port is needed to download the application to the target (and to communicate with the target) the system by default uses COM4 at 38400 baud. When this does not suit you you can specify the port and/or the baudrate.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Specify port and baudrate for serial downloading and communication</span></div>
<div class="line"><span class="preprocessor"></span>SERIAL_PORT      := COM1</div>
<div class="line">SERIAL_BAUDRATE  := 115200</div>
</div><!-- fragment --><p>If you want to change settings globally (for all your projects) you can do so in the bmptk/Makefile.custom file. Create it by copying bmptk/Makefile.local and add the declarations you want to have effect for all your projects. Note that this file is included after your local Makefile, so assignments should be made with ?= so they do not overrule assignments made in the project's Makefile.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># in bmptk/Makefile.custom</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor"># The serial port I use on this PC</span></div>
<div class="line"><span class="preprocessor">SERIAL_PORT      ?= COM19</span></div>
</div><!-- fragment --> <hr/>
<p> <a class="anchor" id="command-line"></a> </p>
<h2>Command line use</h2>
<p>Bmptk is 'driven' by its makefile(s). In most cases you will invoke the Makefile through your GUI, but sometimes it is handy to invoke it directly. The make commands that are recognized are shown in the next table.</p>
<table class="doxtable">
<tr>
<th>command </th><th>effect  </th></tr>
<tr>
<td>make build </td><td>Build the application (compile, link, etc.) </td></tr>
<tr>
<td>----------&mdash;</td><td>-----------------------------------------------&mdash; </td></tr>
<tr>
<td>make run </td><td>Download the application (if needed) and run it. </td></tr>
</table>
<p>| (If necessary, build it first) | ----------&mdash;|-----------------------------------------------&mdash;| make clean | Delete all files generated | | by building the application | </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
